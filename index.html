<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Chat Room</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --primary: #8e44ad;
            --secondary: #2c3e50;
            --bg: #0f0c29;
            --chat-bg: #1a1a2e;
            --accent: #00d2ff;
            --text: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

        body {
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text);
        }

        /* ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        #auth-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            width: 320px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        input[type="password"], input[type="text"] {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            border-radius: 10px;
            border: none;
            background: rgba(0,0,0,0.3);
            color: white;
            outline: none;
            border: 1px solid #444;
        }

        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 100px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        /* ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        #chat-container {
            display: none;
            width: 95%;
            max-width: 600px;
            height: 90vh;
            background: var(--chat-bg);
            flex-direction: column;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }

        .header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            text-align: center;
            border-bottom: 1px solid #333;
            font-size: 20px;
            font-weight: bold;
            color: var(--accent);
        }

        #message-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
        }

        /* ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .msg {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 15px;
            line-height: 1.4;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .mine { align-self: flex-end; background: var(--primary); border-bottom-right-radius: 2px; }
        .friend { align-self: flex-start; background: var(--secondary); border-bottom-left-radius: 2px; }

        .reply-tag {
            display: block;
            font-size: 11px;
            background: rgba(0,0,0,0.2);
            padding: 4px 8px;
            border-radius: 5px;
            margin-bottom: 5px;
            border-left: 3px solid var(--accent);
        }

        /* ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶è‡¶∞‡¶ø‡ßü‡¶æ */
        .footer { padding: 15px; background: #111; border-top: 1px solid #333; }
        #reply-preview {
            display: none;
            justify-content: space-between;
            padding: 8px;
            background: #222;
            font-size: 12px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .input-box { display: flex; gap: 10px; }
    </style>
</head>
<body>

    <div id="auth-container">
        <h2 style="color: var(--accent);">Locked Space</h2>
        <input type="password" id="passInput" placeholder="Password?">
        <button onclick="login()">Enter Chat</button>
        <p id="error" style="color: #ff4757; font-size: 12px; margin-top: 10px;"></p>
    </div>

    <div id="chat-container">
        <div class="header">üîí Private Room</div>
        <div id="message-area"></div>

        <div class="footer">
            <div id="reply-preview">
                <span id="reply-text"></span>
                <span onclick="cancelReply()" style="cursor:pointer; color: red;">‚úï</span>
            </div>
            <div class="input-box">
                <input type="text" id="msgInput" placeholder="Write something..." autocomplete="off">
                <button onclick="send()" style="width: 60px;">‚û§</button>
            </div>
        </div>
    </div>

    <script>
        // --- Firebase Configuration (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞‡¶ü‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶æ‡¶®) ---
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT.firebaseio.com",
            projectId: "YOUR_PROJECT",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const SECRET_PASSWORD = "123"; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°
        let currentReply = null;

        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø (‡¶Ø‡¶æ‡¶§‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ö‡ßá‡¶®‡¶æ ‡¶Ø‡¶æ‡ßü)
        let myID = localStorage.getItem('chat_uid');
        if (!myID) {
            myID = 'user_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('chat_uid', myID);
        }

        // ‡¶≤‡¶ó‡¶á‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function login() {
            const pass = document.getElementById('passInput').value;
            if (pass === SECRET_PASSWORD) {
                document.getElementById('auth-container').style.display = 'none';
                document.getElementById('chat-container').style.display = 'flex';
                startChat();
            } else {
                document.getElementById('error').innerText = "Access Denied!";
            }
        }

        // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
        function send() {
            const input = document.getElementById('msgInput');
            const text = input.value.trim();
            if (!text) return;

            db.ref('messages').push({
                sender: myID,
                message: text,
                replyTo: currentReply,
                time: Date.now()
            });

            input.value = "";
            cancelReply();
        }

        // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠ ‡¶ï‡¶∞‡¶æ (‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶è‡¶¨‡¶Ç ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶¨)
        function startChat() {
            const area = document.getElementById('message-area');
            db.ref('messages').on('child_added', (snap) => {
                const data = snap.val();
                const div = document.createElement('div');
                const isMine = data.sender === myID;
                
                div.className = `msg ${isMine ? 'mine' : 'friend'}`;
                
                let html = "";
                if (data.replyTo) {
                    html += `<span class="reply-tag">Replying to: ${data.replyTo.substring(0, 20)}...</span>`;
                }
                html += `<span>${data.message}</span>`;
                
                div.innerHTML = html;

                // ‡¶°‡¶æ‡¶¨‡¶≤ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶π‡¶¨‡ßá
                div.ondblclick = () => {
                    currentReply = data.message;
                    document.getElementById('reply-preview').style.display = 'flex';
                    document.getElementById('reply-text').innerText = "Replying: " + data.message;
                    document.getElementById('msgInput').focus();
                };

                area.appendChild(div);
                area.scrollTop = area.scrollHeight;
            });
        }

        function cancelReply() {
            currentReply = null;
            document.getElementById('reply-preview').style.display = 'none';
        }

        // Enter key support
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                if (document.getElementById('chat-container').style.display === 'flex') send();
                else login();
            }
        });
    </script>
</body>
</html>